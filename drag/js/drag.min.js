/* Drag component for jQuery ( AMD Module ) | MIT Licenses | 2013-10-27 */
define(function(){var F={axis:null,container:null,handle:null,moveHand:!0,proxy:!1,refresh:!0},r=$.browser.msie&&9>parseInt($.browser.version),z=r&&"6.0"===$.browser.version,s,A={getBoundary:function(a,b){var c=$.isWindow(a[0]),d=0,f=0,k=0,e=0,g=a.offset(),m=b.offset();c?(c=a.scrollTop(),g=a.scrollLeft()):(c=g.top,g=g.left,d=parseFloat(a.css("borderTopWidth")),f=parseFloat(a.css("borderRightWidth")),k=parseFloat(a.css("borderBottomWidth")),e=parseFloat(a.css("borderLeftWidth")));c=c-m.top+parseFloat(b.css("top"));
g=g-m.left+parseFloat(b.css("left"));return{top:c+d,right:g+a.outerWidth()-b.outerWidth()-f,left:g+e,bottom:c+a.outerHeight()-b.outerHeight()-k}},copyPosition:function(a,b){var c=a.offset(),d=b.offset(),f=b.css("top"),k=b.css("left");b.animate({top:c.top-d.top+parseInt(f)+"px",left:c.left-d.left+parseInt(k)+"px"})},createProxy:function(a){var b=a.target,c=b.offset(),d=b.css("zIndex");d?d=parseInt(d)+1:(b.css("zIndex","1"),d="2");s||(s=$('<div class="jcope_drag_proxy" style="position:absolute;border:2px dashed #a0a1a2;"/>'));
s.css({top:c.top+"px",left:c.left+"px",cursor:a.moveHand?"move":"",width:a.width-4+"px",height:a.height-4+"px",zIndex:d});return s}},l=function(a,b){a=$(a).eq(0);b=b||{};if(a.length){var c=$.extend({},F,b),d=a.css("position"),f="fixed"===d||z&&void 0!==a[0].style.getExpression("top"),k=a[0].ownerDocument,e=k.defaultView||k.parentWindow,g=$(e),m=c.handle?$(c.handle):a,p=r?m:$(k),s=c.container?$(c.container):null,l=0,n=this,B=c.axis,C=!1,t=c.proxy,u=c.refresh,q,v,x,y,D,G="getSelection"in e?function(){e.getSelection().removeAllRanges()}:
function(){try{k.selection.empty()}catch(a){}},H=function(b){if(c.isDown&&(l++,0!==l%2)){var d=b.pageX,f=b.pageY,k=t?v[0].style:a[0].style,h,g,e;G();C=!0;x&&(h=d-x,q&&(g=q.left,e=q.right,h=h<g?g:h>e?e:h),n.left=h,n.offsetLeft=d-b.offsetX,k.left=h+"px");y&&(h=f-y,q&&(g=q.top,e=q.bottom,h=h<g?g:h>e?e:h),n.top=h,n.offsetTop=f-b.offsetY,k.top=h+"px");a.trigger("likedrag",[d,f]);$.ui.Drop&&(b.target===m[0]||"jcope_drag_proxy"===b.target.className)&&$.ui.Drop.fire(c,b,!0);b.stopPropagation()}},E=function(b){c.isDown=
!1;r&&p.off("losecapture.drag");p.off("mousemove.drag mouseup.drag");r&&p[0].releaseCapture();C?(t?u?A.copyPosition(v,a):a.css("position","static"===d?"":d):u||a.css(D),z&&(f&&!t)&&a[0].style.setExpression("top","fuckIE6=document.documentElement.scrollTop+"+(n.top-g.scrollTop())+'+"px"'),C=!1,$.ui.Drop&&$.ui.Drop.fire(c,b,!1)):!u&&"static"===d&&a.css("position","");t&&v.remove();m.trigger("likedragend");b.stopPropagation()};u&&"static"===d&&a.css("position","relative");c.moveHand&&m.css("cursor",
"move");m.on("mousedown.drag",function(b){c.isDown=!0;var e=a,l,w,h;c.width=a.outerWidth();c.height=a.outerHeight();u||(d=a.css("position"),"static"===d&&e.css("position","relative"));t&&(v=A.createProxy(c),e=v.appendTo(k.body),r&&(p=v));c.handle=p;l=e.css("left");w=e.css("top");h=e.offset();u||(D={left:l,top:w});n.left=l=parseInt(l);n.top=w=parseInt(w);n.offsetLeft=h.left;n.offsetTop=h.top;x=b.pageX-l;y=b.pageY-w;if(!q&&s||f)q=A.getBoundary(f?g:s,e);B&&("x"===B?y=!1:"y"===B&&(x=!1));r&&p[0].setCapture();
p.on("mousemove.drag",H).on("mouseup.drag",E);if(r)p.on("losecapture.drag",E);z&&(f&&!t)&&a[0].style.removeExpression("top");m.trigger("likedragstart");$.ui.Drop&&$.ui.Drop.refresh();b.stopPropagation();b.preventDefault()});c.originHandle=m;c.target=a;n.__o__=c}};l.prototype={destroy:function(){if(this.__o__){var a=this.__o__;a.originHandle.css("cursor","").off("mousedown.drag likedragstart likedragend");a.isDown&&a.handle.fire("mouseup");a.target.off("likedrag");this.__o__=null;delete this.__o__}},
on:function(a,b){if(!this.__o__)return this;var c=this,d=this.__o__;("drag"===a?d.target:d.originHandle).on("like"+a,function(f,k,e){f.type=a;f.drag=d.target[0];k&&(f.pageX=k,f.pageY=e);b.call(c,f);f.stopPropagation()});return this},un:function(a){if(!this.__o__)return this;var b=this.__o__;("drag"===a?b.target:b.originHandle).off("like"+a);return this}};$.ui||($.ui={});$.ui.Drag=l});
