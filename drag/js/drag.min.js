/* Drag component for jQuery ( AMD Module ) | MIT Licenses | 2013-10-28 */
define(function(){var G={axis:null,container:null,handle:null,moveHand:!0,proxy:!1,refresh:!0},n=$.browser.msie&&9>parseInt($.browser.version),B=n&&"6.0"===$.browser.version,s,p={capitalize:function(a){var b=a.charAt(0);return b.toUpperCase()+a.replace(b,"")},getPosition:function(a,b){var c=a.css("position");if("static"===c)return"auto";if("relative"===c)return"0px";var d=posParams[b][0],f=p.capitalize(d),g=a.offset()[d],e="right"===b||"bottom"===b,h=0,l;if("absolute"===c){l=a[0].offsetParent;if("BODY"===
l.tagName||"HTML"===l.tagName)l=window;c=$(l);$.isWindow(l)||(h=parseFloat(getStyle(c[0],"border"+f+"Width")));d=c.offset()[d]+h}else c=$(window),d=c["scroll"+f]();g-=d;return e?(e=posParams[b][1],c["inner"+e]()-a["outer"+e]()-g+"px"):g+"px"},getBoundary:function(a,b){var c=$.isWindow(a[0]),d=0,f=0,g=0,e=0,h=a.offset(),l=b.offset(),m=b.css("top"),n=b.css("left");"auto"===m&&(m=p.getPosition(b,"top"));"auto"===n&&(n=p.getPosition(b,"left"));c?(c=a.scrollTop(),h=a.scrollLeft()):(c=h.top,h=h.left,d=
parseFloat(a.css("borderTopWidth")),f=parseFloat(a.css("borderRightWidth")),g=parseFloat(a.css("borderBottomWidth")),e=parseFloat(a.css("borderLeftWidth")));c=c-l.top+parseFloat(m);h=h-l.left+parseFloat(n);return{top:c+d,right:h+a.outerWidth()-b.outerWidth()-f,left:h+e,bottom:c+a.outerHeight()-b.outerHeight()-g}},copyPosition:function(a,b){var c=a.offset(),d=b.offset(),f=b.css("top"),g=b.css("left");"auto"===f&&(f=p.getPosition(b,"top"));"auto"===g&&(g=p.getPosition(b,"left"));b.animate({top:c.top-
d.top+parseInt(f)+"px",left:c.left-d.left+parseInt(g)+"px"})},createProxy:function(a){var b=a.target,c=b.offset(),d=b.css("zIndex");d?d=parseInt(d)+1:(b.css("zIndex","1"),d="2");s||(s=$('<div class="ecope_drag_proxy" style="position:absolute;border:2px dashed #a0a1a2;"/>'));s.css({top:c.top+"px",left:c.left+"px",cursor:a.moveHand?"move":"",width:a.width-4+"px",height:a.height-4+"px",zIndex:d});return s}},y=function(a,b){a=$(a).eq(0);b=b||{};if(a.length){var c=$.extend({},G,b),d=a.css("position"),
f="fixed"===d||B&&void 0!==a[0].style.getExpression("top"),g=a[0].ownerDocument,e=g.defaultView||g.parentWindow,h=$(e),l=c.handle?$(c.handle):a,m=n?l:$(g),s=c.container?$(c.container):null,y=0,q=this,C=c.axis,D=!1,v=c.proxy,w=c.refresh,r,x,z,A,E,H="getSelection"in e?function(){e.getSelection().removeAllRanges()}:function(){try{g.selection.empty()}catch(a){}},I=function(b){if(c.isDown&&(y++,0!==y%2)){var d=b.pageX,f=b.pageY,g=v?x[0].style:a[0].style,k,h,e;H();D=!0;z&&(k=d-z,r&&(h=r.left,e=r.right,
k=k<h?h:k>e?e:k),q.left=k,q.offsetLeft=d-b.offsetX,g.left=k+"px");A&&(k=f-A,r&&(h=r.top,e=r.bottom,k=k<h?h:k>e?e:k),q.top=k,q.offsetTop=f-b.offsetY,g.top=k+"px");a.trigger("likedrag",[d,f]);$.ui.Drop&&(b.target===l[0]||"ecope_drag_proxy"===b.target.className)&&$.ui.Drop.fire(c,b,!0);b.stopPropagation()}},F=function(b){c.isDown=!1;n&&m.off("losecapture.drag");m.off("mousemove.drag mouseup.drag");n&&m[0].releaseCapture();D?(v?w?p.copyPosition(x,a):a.css("position","static"===d?"":d):w||a.css(E),B&&
(f&&!v)&&a[0].style.setExpression("top","fuckIE6=document.documentElement.scrollTop+"+(q.top-h.scrollTop())+'+"px"'),D=!1,$.ui.Drop&&$.ui.Drop.fire(c,b,!1)):!w&&"static"===d&&a.css("position","");v&&x.remove();l.trigger("likedragend");b.stopPropagation()};w&&"static"===d&&a.css("position","relative");c.moveHand&&l.css("cursor","move");l.on("mousedown.drag",function(b){c.isDown=!0;var e=a,t,u,k;c.width=a.outerWidth();c.height=a.outerHeight();w||(d=a.css("position"),"static"===d&&e.css("position","relative"));
v&&(x=p.createProxy(c),e=x.appendTo(g.body),n&&(m=x));c.handle=m;t=e.css("left");u=e.css("top");k=e.offset();"auto"===u&&(u=p.getPosition(a,"top"));"auto"===t&&(t=p.getPosition(a,"left"));w||(E={left:t,top:u});q.left=t=parseInt(t);q.top=u=parseInt(u);q.offsetLeft=k.left;q.offsetTop=k.top;z=b.pageX-t;A=b.pageY-u;if(!r&&s||f)r=p.getBoundary(f?h:s,e);C&&("x"===C?A=!1:"y"===C&&(z=!1));n&&m[0].setCapture();m.on("mousemove.drag",I).on("mouseup.drag",F);if(n)m.on("losecapture.drag",F);B&&(f&&!v)&&a[0].style.removeExpression("top");
l.trigger("likedragstart");$.ui.Drop&&$.ui.Drop.refresh();b.stopPropagation();b.preventDefault()});c.originHandle=l;c.target=a;q.__o__=c}};y.prototype={destroy:function(){if(this.__o__){var a=this.__o__;a.originHandle.css("cursor","").off("mousedown.drag likedragstart likedragend");a.isDown&&a.handle.fire("mouseup");a.target.off("likedrag");this.__o__=null;delete this.__o__}},on:function(a,b){if(!this.__o__)return this;var c=this,d=this.__o__;("drag"===a?d.target:d.originHandle).on("like"+a,function(f,
g,e){f.type=a;f.drag=d.target[0];g&&(f.pageX=g,f.pageY=e);b.call(c,f);f.stopPropagation()});return this},un:function(a){if(!this.__o__)return this;var b=this.__o__;("drag"===a?b.target:b.originHandle).off("like"+a);return this}};$.ui||($.ui={});$.ui.Drag=y});
